syntax = "proto3";

service Sled {
  rpc Command(CommandRequest) returns (CommandSet);
  rpc Update(UpdateRequest) returns (UpdateResponse);
}


message CommandRequest { 
  string mac = 1;
}
message UpdateResponse { 
  bool success = 1;
  string message = 2;
}

message UpdateRequest {
  string mac = 1;
  CommandSet commandSet = 2;
}

message CommandSet {
  Wipe wipe = 1;
  Write write = 2;
  Kexec kexec = 3;
}

message Wipe {
  string device = 1;
}

message Write {
  string name = 1;
  string device = 2;
  bytes image = 3;
}


message Kexec {
  string kernel = 1;
  string append = 2;
  string initrd = 3;
}
